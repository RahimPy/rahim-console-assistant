<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéÆ Console Auto Form</title>
    <meta name="robots" content="noindex, nofollow">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: 
                radial-gradient(circle at 20% 30%, rgba(15, 30, 50, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(30, 15, 40, 0.3) 0%, transparent 50%),
                linear-gradient(135deg, #0a0e17 0%, #151a2d 30%, #1a1f2e 70%, #0f1525 100%);
            background-attachment: fixed;
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 10% 20%, rgba(100, 150, 255, 0.03) 0%, transparent 30%),
                radial-gradient(circle at 90% 80%, rgba(150, 100, 255, 0.02) 0%, transparent 30%);
            pointer-events: none;
            z-index: 0;
        }
        
        .app-container {
            display: flex;
            gap: 20px;
            max-width: 1600px;
            margin: 0 auto;
        }
        
        /* Main Content */
        .main-content {
            flex: 1;
            background: rgba(20, 25, 40, 0.85);
            border-radius: 16px;
            border: 1px solid rgba(66, 153, 225, 0.25);
            backdrop-filter: blur(10px);
            box-shadow: 
                0 25px 50px -12px rgba(0, 0, 0, 0.3),
                0 0 0 1px rgba(66, 153, 225, 0.15);
            overflow: hidden;
        }
        
        .main-header {
            background: linear-gradient(90deg, 
                rgba(30, 41, 59, 0.9) 0%, 
                rgba(66, 153, 225, 0.2) 50%,
                rgba(30, 41, 59, 0.9) 100%);
            padding: 25px 30px;
            border-bottom: 1px solid rgba(66, 153, 225, 0.2);
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .hamburger-menu {
            background: rgba(66, 153, 225, 0.1);
            border: 1px solid rgba(66, 153, 225, 0.3);
            border-radius: 8px;
            width: 40px;
            height: 40px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #90cdf4;
            font-size: 20px;
            transition: all 0.3s;
        }
        
        .hamburger-menu:hover {
            background: rgba(66, 153, 225, 0.2);
            transform: translateY(-2px);
        }
        
        .header-title {
            flex: 1;
        }
        
        .header-title h2 {
            color: #ffffff;
            font-size: 28px;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(66, 153, 225, 0.3);
        }
        
        .header-title p {
            color: #90cdf4;
            font-size: 16px;
            opacity: 0.9;
        }
        
        .form-section {
            padding: 30px;
            background: transparent;
        }
        
        .form-group {
            margin-bottom: 24px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: #90cdf4;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .required::after {
            content: " *";
            color: #ff3333;
            font-weight: bold;
        }
        
        .form-group input, .form-group select {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid rgba(66, 153, 225, 0.3);
            border-radius: 10px;
            font-size: 15px;
            transition: all 0.3s;
            background: rgba(30, 41, 59, 0.7) !important;
            color: #ffffff;
            backdrop-filter: blur(5px);
        }
        
        .form-group input::placeholder {
            color: #a0aec0;
        }
        
        .form-group select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2390cdf4' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 16px center;
            background-size: 16px;
        }
        
        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #4299e1;
            box-shadow: 0 0 0 2px rgba(66, 153, 225, 0.2);
            background: rgba(30, 41, 59, 0.9) !important;
        }
        
        .form-selector {
            display: flex;
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .form-option {
            flex: 1;
            padding: 20px 15px;
            border: 1px solid rgba(66, 153, 225, 0.3);
            border-radius: 12px;
            background: rgba(30, 41, 59, 0.7);
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        
        .form-option:hover {
            border-color: rgba(66, 153, 225, 0.5);
            background: rgba(30, 41, 59, 0.9);
        }
        
        .form-option[data-form="form1"].selected {
            border-color: #ff3333;
            background: linear-gradient(135deg, rgba(255, 51, 51, 0.15), rgba(30, 41, 59, 0.9));
            box-shadow: 0 0 15px rgba(255, 51, 51, 0.5);
        }
        
        .form-option[data-form="form2"].selected {
            border-color: #ff3333;
            background: linear-gradient(135deg, rgba(255, 51, 51, 0.15), rgba(30, 41, 59, 0.9));
            box-shadow: 0 0 15px rgba(255, 51, 51, 0.5);
        }
        
        .form-option[data-form="form3"].selected {
            border-color: #00cc66;
            background: linear-gradient(135deg, rgba(0, 204, 102, 0.15), rgba(30, 41, 59, 0.9));
            box-shadow: 0 0 15px rgba(0, 204, 102, 0.5);
        }
        
        .form-option.selected::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            border-radius: 12px 12px 0 0;
        }
        
        .form-option[data-form="form1"].selected::before,
        .form-option[data-form="form2"].selected::before {
            background: linear-gradient(90deg, #ff3333, #ff6666);
        }
        
        .form-option[data-form="form3"].selected::before {
            background: linear-gradient(90deg, #00cc66, #66ff99);
        }
        
        .form-option .form-icon {
            font-size: 26px;
            margin-bottom: 8px;
            display: block;
            color: #90cdf4;
        }
        
        .form-option.selected .form-icon {
            color: #ffffff;
        }
        
        .form-option[data-form="form1"].selected .form-icon,
        .form-option[data-form="form2"].selected .form-icon {
            color: #ff3333;
            text-shadow: 0 0 10px rgba(255, 51, 51, 0.5);
        }
        
        .form-option[data-form="form3"].selected .form-icon {
            color: #00cc66;
            text-shadow: 0 0 10px rgba(0, 204, 102, 0.5);
        }
        
        .form-option .form-name {
            font-weight: 600;
            font-size: 15px;
            margin-bottom: 5px;
            color: #ffffff;
        }
        
        .form-option.selected .form-name {
            font-weight: 700;
        }
        
        .form-option[data-form="form1"].selected .form-name,
        .form-option[data-form="form2"].selected .form-name {
            color: #ff3333;
            text-shadow: 0 0 5px rgba(255, 51, 51, 0.3);
        }
        
        .form-option[data-form="form3"].selected .form-name {
            color: #00cc66;
            text-shadow: 0 0 5px rgba(0, 204, 102, 0.3);
        }
        
        .form-option .form-desc {
            font-size: 12px;
            color: #a0aec0;
            line-height: 1.4;
        }
        
        .form-option.selected .form-desc {
            color: #cccccc;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        @media (max-width: 1400px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }
        
        .preview-box {
            background: rgba(30, 41, 59, 0.5);
            border: 1px solid rgba(66, 153, 225, 0.3);
            border-radius: 10px;
            padding: 16px;
            margin-top: 15px;
            font-size: 14px;
            color: #a0aec0;
        }
        
        .button-group {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 32px;
        }
        
        @media (max-width: 1200px) {
            .button-group {
                grid-template-columns: 1fr;
            }
        }
        
        .btn {
            padding: 16px;
            border: none;
            border-radius: 10px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            position: relative;
            overflow: hidden;
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(255, 255, 255, 0.1), 
                transparent);
            transition: left 0.5s;
        }
        
        .btn:hover:not(:disabled)::before {
            left: 100%;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #4299e1, #3182ce);
            color: white;
            border: 1px solid rgba(66, 153, 225, 0.3);
        }
        
        .btn-primary:hover:not(:disabled) {
            background: linear-gradient(135deg, #3182ce, #2b6cb0);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(66, 153, 225, 0.4);
        }
        
        .btn-success {
            background: linear-gradient(135deg, #00cc66, #00aa55);
            color: white;
            border: 1px solid rgba(0, 204, 102, 0.3);
        }
        
        .btn-success:hover:not(:disabled) {
            background: linear-gradient(135deg, #00aa55, #008844);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 204, 102, 0.4);
        }
        
        .btn-clear {
            background: rgba(255, 51, 51, 0.1);
            color: #ff6666;
            border: 1px solid rgba(255, 51, 51, 0.3);
        }
        
        .btn-clear:hover {
            background: rgba(255, 51, 51, 0.2);
            border-color: #ff3333;
        }
        
        /* Success Message */
        .success-message {
            background: rgba(0, 204, 102, 0.1);
            border: 1px solid rgba(0, 204, 102, 0.3);
            color: #66ff99;
            padding: 18px;
            border-radius: 10px;
            margin-top: 24px;
            display: none;
            text-align: center;
            font-size: 15px;
        }
        
        /* Not Testable Info Box */
        .not-testable-box {
            background: rgba(255, 193, 7, 0.1);
            border: 1px solid rgba(255, 193, 7, 0.3);
            border-left: 4px solid #ffc107;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            color: #ffd54f;
            font-size: 14px;
            display: none;
        }
        
        .not-testable-box.show {
            display: block;
        }
        
        .not-testable-title {
            color: #ffd700;
            font-weight: 700;
            margin-bottom: 8px;
            font-size: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .not-testable-list {
            list-style: none;
            margin: 5px 0 0 0;
            padding-left: 20px;
        }
        
        .not-testable-list li {
            margin-bottom: 5px;
            padding-left: 5px;
            position: relative;
            font-size: 13px;
        }
        
        .not-testable-list li:before {
            content: "‚Ä¢";
            color: #ffc107;
            font-size: 16px;
            position: absolute;
            left: -12px;
        }
        
        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 0;
            left: -450px;
            width: 450px;
            height: 100vh;
            background: rgba(20, 25, 40, 0.98);
            border-right: 1px solid rgba(66, 153, 225, 0.3);
            box-shadow: 5px 0 25px rgba(0, 0, 0, 0.5);
            z-index: 1001;
            transition: left 0.3s ease-in-out;
            display: flex;
            flex-direction: column;
            backdrop-filter: blur(10px);
        }
        
        .sidebar.open {
            left: 0;
        }
        
        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid rgba(66, 153, 225, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .sidebar-header h2 {
            color: #90cdf4;
            font-size: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .close-sidebar {
            background: rgba(255, 51, 51, 0.2);
            border: 1px solid rgba(255, 51, 51, 0.4);
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            transition: all 0.3s;
        }
        
        .close-sidebar:hover {
            background: rgba(255, 51, 51, 0.4);
        }
        
        .sidebar-content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }
        
        /* Big Monkey in Sidebar */
        .sidebar-monkey {
            text-align: center;
            margin: 10px 0 20px 0;
            font-size: 60px;
            animation: bounce 1s infinite alternate;
            opacity: 1;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
        }
        
        /* Stats Dashboard in Sidebar */
        .stats-dashboard {
            margin-bottom: 30px;
        }
        
        .stats-title {
            color: #90cdf4;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .stats-tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 15px;
        }
        
        .stats-tab {
            flex: 1;
            padding: 8px;
            text-align: center;
            background: rgba(30, 41, 59, 0.7);
            border: 1px solid rgba(66, 153, 225, 0.2);
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            color: #a0aec0;
            transition: all 0.3s;
        }
        
        .stats-tab.active {
            background: rgba(66, 153, 225, 0.2);
            color: #90cdf4;
            border-color: rgba(66, 153, 225, 0.4);
        }
        
        .stats-tab:hover:not(.active) {
            background: rgba(30, 41, 59, 0.9);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: rgba(30, 41, 59, 0.7);
            border: 1px solid rgba(66, 153, 225, 0.3);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-2px);
            border-color: rgba(66, 153, 225, 0.5);
            background: rgba(30, 41, 59, 0.8);
        }
        
        .stat-value {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 12px;
            color: #a0aec0;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .stat-total .stat-value { color: #4299e1; }
        .stat-passed .stat-value { color: #00cc66; }
        .stat-failed .stat-value { color: #ff3333; }
        .stat-queued .stat-value { color: #ffd700; }
        
        /* Console Statistics */
        .console-stats {
            margin-bottom: 30px;
        }
        
        .console-search {
            width: 100%;
            padding: 10px 12px;
            background: rgba(30, 41, 59, 0.7);
            border: 1px solid rgba(66, 153, 225, 0.3);
            border-radius: 8px;
            color: #ffffff;
            margin-bottom: 15px;
            font-size: 14px;
        }
        
        .console-search::placeholder {
            color: #a0aec0;
        }
        
        .console-categories {
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .console-category {
            background: rgba(30, 41, 59, 0.7);
            border: 1px solid rgba(66, 153, 225, 0.2);
            border-radius: 8px;
            padding: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .console-category:hover {
            background: rgba(30, 41, 59, 0.9);
            border-color: rgba(66, 153, 225, 0.4);
        }
        
        .console-category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 5px;
        }
        
        .console-name {
            font-weight: 600;
            color: #ffffff;
            font-size: 14px;
        }
        
        .console-counts {
            display: flex;
            gap: 15px;
            font-size: 12px;
        }
        
        .today-count {
            color: #ffd700;
        }
        
        .alltime-count {
            color: #4299e1;
        }
        
        .console-breakdown {
            font-size: 11px;
            color: #a0aec0;
            margin-top: 5px;
            padding-left: 5px;
        }
        
        .breakdown-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 3px;
        }
        
        /* Queue Content */
        .queue-content {
            margin-top: 30px;
        }
        
        .queue-item {
            background: rgba(30, 41, 59, 0.7);
            border: 1px solid rgba(66, 153, 225, 0.2);
            border-left: 4px solid #4299e1;
            border-radius: 10px;
            padding: 16px;
            margin-bottom: 12px;
            transition: all 0.3s;
        }
        
        .queue-item:hover {
            background: rgba(30, 41, 59, 0.9);
            transform: translateX(-5px);
        }
        
        .queue-item.form1 {
            border-left-color: #ff3333;
        }
        
        .queue-item.form2 {
            border-left-color: #ff3333;
        }
        
        .queue-item.form3 {
            border-left-color: #00cc66;
        }
        
        .queue-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .queue-item-id {
            font-size: 16px;
            font-weight: 700;
            color: #ffffff;
        }
        
        .queue-item-type {
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: 600;
        }
        
        .queue-item-type.form1 {
            background: rgba(255, 51, 51, 0.2);
            color: #ff6666;
        }
        
        .queue-item-type.form2 {
            background: rgba(255, 51, 51, 0.2);
            color: #ff6666;
        }
        
        .queue-item-type.form3 {
            background: rgba(0, 204, 102, 0.2);
            color: #66ff99;
        }
        
        .queue-item-details {
            color: #a0aec0;
            font-size: 13px;
            line-height: 1.6;
            margin-bottom: 10px;
        }
        
        .queue-item-time {
            color: #90cdf4;
            font-size: 12px;
            margin-bottom: 10px;
        }
        
        .queue-item-actions {
            display: flex;
            gap: 8px;
        }
        
        .queue-item-btn {
            flex: 1;
            padding: 8px;
            border: 1px solid rgba(66, 153, 225, 0.3);
            border-radius: 6px;
            background: rgba(66, 153, 225, 0.1);
            color: #90cdf4;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }
        
        .queue-item-btn:hover {
            background: rgba(66, 153, 225, 0.2);
            border-color: #4299e1;
        }
        
        .queue-item-btn.delete {
            background: rgba(255, 51, 51, 0.1);
            border-color: rgba(255, 51, 51, 0.3);
            color: #ff6666;
        }
        
        .queue-item-btn.delete:hover {
            background: rgba(255, 51, 51, 0.2);
        }
        
        .queue-empty {
            text-align: center;
            padding: 60px 20px;
            color: #a0aec0;
        }
        
        .queue-empty-icon {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.3;
        }
        
        .queue-empty-text {
            font-size: 16px;
            line-height: 1.6;
        }
        
        /* Sidebar Footer */
        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid rgba(66, 153, 225, 0.2);
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .sidebar-footer-btn {
            padding: 14px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .sidebar-footer-btn.primary {
            background: linear-gradient(135deg, #4299e1, #90cdf4);
            color: white;
        }
        
        .sidebar-footer-btn.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(66, 153, 225, 0.4);
        }
        
        .sidebar-footer-btn.secondary {
            background: rgba(66, 153, 225, 0.1);
            color: #90cdf4;
            border: 1px solid rgba(66, 153, 225, 0.3);
        }
        
        .sidebar-footer-btn.secondary:hover {
            background: rgba(66, 153, 225, 0.2);
        }
        
        /* Backdrop */
        .sidebar-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            display: none;
            backdrop-filter: blur(2px);
        }
        
        .sidebar-backdrop.show {
            display: block;
        }
        
        /* Info Sections with Clean Border */
        .info-section {
            background: linear-gradient(145deg, rgba(30, 41, 59, 0.95), rgba(15, 23, 42, 0.95));
            border-radius: 12px;
            padding: 25px;
            margin: 30px;
            border: 1px solid rgba(66, 153, 225, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        .info-section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #8b5cf6, #3b82f6);
        }
        
        .info-title {
            color: #90cdf4;
            font-size: 20px;
            margin-bottom: 20px;
            text-transform: uppercase;
            letter-spacing: 1px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .info-content {
            color: #ffffff;
            font-size: 14px;
            line-height: 1.6;
        }
        
        .info-content strong {
            color: #ffd700;
        }
        
        .info-list {
            list-style: none;
            margin: 15px 0;
            padding-left: 20px;
        }
        
        .info-list li {
            margin-bottom: 10px;
            padding-left: 10px;
            position: relative;
        }
        
        .info-list li:before {
            content: "‚Ä¢";
            color: #4299e1;
            font-size: 20px;
            position: absolute;
            left: -15px;
        }
        
        /* Notes with clean background */
        .info-note {
            background: rgba(30, 41, 59, 0.5);
            border: 1px solid rgba(66, 153, 225, 0.2);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            color: #ffffff;
            font-size: 14px;
            line-height: 1.6;
        }
        
        /* Red Important Warning Box */
        .warning-box {
            background: rgba(255, 51, 51, 0.1);
            border: 1px solid rgba(255, 51, 51, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            color: #ff9999;
            font-size: 14px;
        }
        
        .warning-title {
            color: #ff6666;
            font-weight: 700;
            margin-bottom: 8px;
            font-size: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* Keyboard Shortcuts Panel - RESPONSIVE FIX */
        .keyboard-shortcuts-panel {
            background: linear-gradient(145deg, rgba(30, 41, 59, 0.95), rgba(15, 23, 42, 0.95));
            border-radius: 12px;
            padding: 25px;
            margin: 30px 30px 30px 0;
            border: 1px solid rgba(66, 153, 225, 0.2);
            position: relative;
            overflow: hidden;
            flex: 1;
            min-width: 300px;
            max-width: 400px;
        }
        
        .keyboard-shortcuts-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #8b5cf6, #3b82f6);
        }
        
        .shortcut-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #334155;
        }
        
        .shortcut-item:last-child {
            border-bottom: none;
        }
        
        .shortcut-key {
            background: #1e293b;
            padding: 4px 12px;
            border-radius: 6px;
            font-family: monospace;
            color: #fbbf24;
            border: 1px solid #475569;
        }
        
        .shortcut-desc {
            color: #cbd5e1;
        }
        
        /* Footer Signature with MULTI-COLOR NAME */
        .footer-signature {
            text-align: center;
            padding: 20px;
            margin-top: 30px;
            border-top: 1px solid rgba(66, 153, 225, 0.2);
        }
        
        .created-by {
            color: #ffffff;
            font-size: 16px;
            margin-bottom: 10px;
        }
        
        .rahim-name {
            font-size: 24px;
            font-weight: 700;
            background: linear-gradient(
                90deg,
                #60a5fa,    /* Light Blue */
                #ffffff,    /* White */
                #f9a8d4,    /* Light Pink */
                #d8b4fe,    /* Light Purple */
                #fbbf24,    /* Amber */
                #34d399,    /* Emerald */
                #f87171,    /* Red */
                #60a5fa     /* Back to Light Blue */
            );
            background-size: 400% 100%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: gradientShift 8s ease infinite;
            padding: 5px 20px;
            border-radius: 10px;
            display: inline-block;
        }
        
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .monkey-emojis {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .monkey {
            font-size: 24px;
            animation: bounce 1s infinite alternate;
        }
        
        .monkey:nth-child(2) {
            animation-delay: 0.2s;
        }
        
        .monkey:nth-child(3) {
            animation-delay: 0.4s;
        }
        
        @keyframes bounce {
            from {
                transform: translateY(0);
            }
            to {
                transform: translateY(-10px);
            }
        }
        
        /* Loading Spinner */
        .loading-spinner {
            display: none;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .btn-primary.loading .loading-spinner {
            display: inline-block;
        }
        
        .btn-primary.loading .icon {
            display: none;
        }
        
        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: rgba(30, 41, 59, 0.5);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #4299e1 0%, #90cdf4 100%);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, #3182ce 0%, #63b3ed 100%);
        }
        
        /* Tabs for Console Stats */
        .console-tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 15px;
        }
        
        .console-tab {
            flex: 1;
            padding: 8px;
            text-align: center;
            background: rgba(30, 41, 59, 0.7);
            border: 1px solid rgba(66, 153, 225, 0.2);
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            color: #a0aec0;
            transition: all 0.3s;
        }
        
        .console-tab.active {
            background: rgba(66, 153, 225, 0.2);
            color: #90cdf4;
            border-color: rgba(66, 153, 225, 0.4);
        }
        
        .console-tab:hover:not(.active) {
            background: rgba(30, 41, 59, 0.9);
        }
        
        /* Responsive */
        @media (max-width: 1200px) {
            .button-group {
                grid-template-columns: 1fr 1fr;
            }
            
            .keyboard-shortcuts-panel {
                margin: 20px;
                max-width: none;
            }
        }
        
        @media (max-width: 768px) {
            .button-group {
                grid-template-columns: 1fr;
            }
            
            .form-selector {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                left: -100%;
            }
            
            .main-header {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .info-section, .keyboard-shortcuts-panel {
                margin: 20px;
                padding: 20px;
            }
            
            .keyboard-shortcuts-panel {
                margin-top: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar-backdrop" id="sidebarBackdrop" onclick="closeSidebar()"></div>
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h2>
                üìä Dashboard & Queue
            </h2>
            <button class="close-sidebar" onclick="closeSidebar()">√ó</button>
        </div>
        
        <div class="sidebar-content">
            <!-- Big Monkey in Sidebar -->
            <div class="sidebar-monkey">üêµ</div>
            
            <!-- Stats Dashboard -->
            <div class="stats-dashboard">
                <div class="stats-title">
                    <i class="fas fa-chart-bar"></i>
                    Statistics
                </div>
                <div class="stats-tabs">
                    <div class="stats-tab active" onclick="switchStatsTab('today')">Today</div>
                    <div class="stats-tab" onclick="switchStatsTab('alltime')">All Time</div>
                </div>
                <div class="stats-grid">
                    <div class="stat-card stat-total">
                        <div class="stat-value" id="statTotal">0</div>
                        <div class="stat-label">Total Forms</div>
                    </div>
                    <div class="stat-card stat-passed">
                        <div class="stat-value" id="statPassed">0</div>
                        <div class="stat-label">Passed</div>
                    </div>
                    <div class="stat-card stat-failed">
                        <div class="stat-value" id="statFailed">0</div>
                        <div class="stat-label">Failed</div>
                    </div>
                    <div class="stat-card stat-queued">
                        <div class="stat-value" id="statQueued">0</div>
                        <div class="stat-label">In Queue</div>
                    </div>
                </div>
            </div>
            
            <!-- Console Statistics -->
            <div class="console-stats">
                <div class="stats-title">
                    <i class="fas fa-gamepad"></i>
                    Console Statistics
                </div>
                <input type="text" class="console-search" id="consoleSearch" placeholder="Search consoles..." onkeyup="filterConsoles()">
                
                <div class="console-tabs">
                    <div class="console-tab active" onclick="switchConsoleTab('today')">Today</div>
                    <div class="console-tab" onclick="switchConsoleTab('alltime')">All Time</div>
                </div>
                
                <div class="console-categories" id="consoleCategories">
                    <!-- Console categories will be inserted here -->
                </div>
            </div>
            
            <!-- Queue Content -->
            <div class="queue-content">
                <div class="stats-title">
                    <i class="fas fa-list"></i>
                    Console Queue (<span id="queueCount">0</span>)
                </div>
                <div id="queueContent">
                    <!-- Queue items will be inserted here -->
                </div>
            </div>
        </div>
        
        <div class="sidebar-footer">
            <button class="sidebar-footer-btn primary" onclick="submitAllQueued()" id="submitAllBtn">
                üì§ Open All Forms
            </button>
            <button class="sidebar-footer-btn secondary" onclick="exportQueueAsCSV()">
                üíæ Export as CSV
            </button>
            <button class="sidebar-footer-btn secondary" onclick="clearQueue()" style="color: #ff6666; border-color: rgba(255, 51, 51, 0.3);">
                üóëÔ∏è Clear Queue
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
        <div class="main-header">
            <div class="hamburger-menu" onclick="openSidebar()">
                ‚ò∞
            </div>
            <div class="header-title">
                <h2>üéÆ Console Auto Form</h2>
                <p>Automated Console Testing Tool</p>
            </div>
            <!-- NAME REMOVED FROM HEADER -->
        </div>
        
        <!-- Form Section -->
        <div class="form-section" autocomplete="off">
            <!-- Form Selector -->
            <div class="form-group">
                <label class="required">SELECT FORM TYPE *</label>
                <div class="form-selector">
                    <div class="form-option selected" onclick="selectForm('form1')" id="form1Option" data-form="form1">
                        <span class="form-icon">üü¢</span>
                        <div class="form-name">FAILED TEST</div>
                        <div class="form-desc">Detailed testing with cascade logic</div>
                    </div>
                    <div class="form-option" onclick="selectForm('form2')" id="form2Option" data-form="form2">
                        <span class="form-icon">üî¥</span>
                        <div class="form-name">REJECTION</div>
                        <div class="form-desc">Single reason rejection</div>
                    </div>
                    <div class="form-option" onclick="selectForm('form3')" id="form3Option" data-form="form3">
                        <span class="form-icon">‚úÖ</span>
                        <div class="form-name">PASS ALL TESTS</div>
                        <div class="form-desc">All tests passed or not testable</div>
                    </div>
                </div>
                <div class="preview-box" id="formPreview">
                    Currently selected: <strong style="color:#ff3333">FAILED TEST</strong> ‚Äî Detailed testing with cascade logic
                </div>
            </div>
            
            <!-- Basic Information -->
            <div class="form-group">
                <div class="form-row">
                    <div>
                        <label class="required" for="item_id">ITEM ID *</label>
                        <input type="text" id="item_id" placeholder="Enter Item ID (e.g., 0012345)" autocomplete="off">
                    </div>
                    <div>
                        <label class="required" for="serial">SERIAL NUMBER *</label>
                        <input type="text" id="serial" placeholder="Enter Serial Number" autocomplete="off">
                    </div>
                </div>
            </div>
            
            <!-- Live Form Fields - HIDDEN FOR FORM3 -->
            <div id="liveFormFields">
                <div class="form-group">
                    <label class="required" for="model">MODEL *</label>
                    <select id="model" autocomplete="off" onchange="updateNotTestableInfo()">
                        <option value="">-- Select Model --</option>
                        <option value="Asus ROG Ally (2023)">Asus ROG Ally (2023)</option>
                        <option value="Asus ROG Ally X (2024)">Asus ROG Ally X (2024)</option>
                        <option value="Lenovo Legion Go">Lenovo Legion Go</option>
                        <option value="Nintendo DS">Nintendo DS</option>
                        <option value="Nintendo 2DS (Original)">Nintendo 2DS (Original)</option>
                        <option value="Nintendo 3DS (Original)">Nintendo 3DS (Original)</option>
                        <option value="Nintendo 3DS XL">Nintendo 3DS XL</option>
                        <option value="New Nintendo 3DS">New Nintendo 3DS</option>
                        <option value="New Nintendo 3DS XL">New Nintendo 3DS XL</option>
                        <option value="New Nintendo 2DS XL">New Nintendo 2DS XL</option>
                        <option value="Nintendo DSi">Nintendo DSi</option>
                        <option value="Nintendo DSi XL">Nintendo DSi XL</option>
                        <option value="Nintendo 64 (Original)">Nintendo 64 (Original)</option>
                        <option value="Nintendo Switch">Nintendo Switch</option>
                        <option value="Nintendo Switch 2">Nintendo Switch 2</option>
                        <option value="Nintendo Game Boy">Nintendo Game Boy</option>
                        <option value="Nintendo Game Boy Advance">Nintendo Game Boy Advance</option>
                        <option value="Nintendo Wii">Nintendo Wii</option>
                        <option value="Nintendo Wii U">Nintendo Wii U</option>
                        <option value="PlayStation 1">PlayStation 1</option>
                        <option value="PlayStation 2">PlayStation 2</option>
                        <option value="PlayStation 3">PlayStation 3</option>
                        <option value="PlayStation 4">PlayStation 4</option>
                        <option value="PlayStation 4 slim">PlayStation 4 slim</option>
                        <option value="PlayStation 4 pro">PlayStation 4 pro</option>
                        <option value="PlayStation 5">PlayStation 5</option>
                        <option value="PlayStation 5 digital">PlayStation 5 digital</option>
                        <option value="PlayStation 5 pro">PlayStation 5 pro</option>
                        <option value="PlayStation Portal 2025">PlayStation Portal 2025</option>
                        <option value="PlayStation Portable">PlayStation Portable</option>
                        <option value="PlayStation Vita">PlayStation Vita</option>
                        <option value="Steam Deck">Steam Deck</option>
                        <option value="Xbox (original)">Xbox (original)</option>
                        <option value="Xbox 360">Xbox 360</option>
                        <option value="Xbox One (Original)">Xbox One (Original)</option>
                        <option value="Xbox One S">Xbox One S</option>
                        <option value="Xbox One X">Xbox One X</option>
                        <option value="Xbox Series S">Xbox Series S</option>
                        <option value="Xbox Series X">Xbox Series X</option>
                        <option value="device not supported">device not supported</option>
                    </select>
                </div>
                
                <div class="form-group" id="failureFields">
                    <div class="form-row">
                        <div>
                            <label class="required" for="failure_point">FIRST FAILURE POINT *</label>
                            <select id="failure_point" onchange="updateFailureReasons()" autocomplete="off">
                                <option value="">-- Select where it first failed --</option>
                                <option value="auth">Authenticity check</option>
                                <option value="boot">Powering on and booting up</option>
                                <option value="buttons">Buttons test</option>
                                <option value="jailbreak">Jailbreak test</option>
                                <option value="network">Network connections test</option>
                                <option value="accounts">Accounts check</option>
                                <option value="ports">Ports test</option>
                                <option value="disc_storage">Disc drive and storage test</option>
                                <option value="battery">Battery test</option>
                                <option value="display">Display test</option>
                                <option value="speaker_mic">Speaker and microphone test</option>
                                <option value="load">Load test</option>
                                <option value="noise_smell">Noise and smell test</option>
                                <option value="controller">Controller test (incl. vibration)</option>
                                <option value="accessories">Accessories</option>
                            </select>
                        </div>
                        <div>
                            <label class="required" for="failure_reason">FAILURE REASON *</label>
                            <select id="failure_reason" autocomplete="off">
                                <option value="">Select failure point first</option>
                            </select>
                        </div>
                    </div>
                    <div class="preview-box" id="previewBox">
                        Failure reason will be auto-filled based on your selection
                    </div>
                </div>
            </div>
            
            <!-- Rejection Form Fields -->
            <div id="rejectionFormFields" style="display: none;">
                <div class="form-group">
                    <label class="required" for="rejection_reason">REJECTION REASON *</label>
                    <select id="rejection_reason" autocomplete="off">
                        <option value="">-- Select Rejection Reason --</option>
                        <option value="ARRIVED_DAMAGED">ARRIVED_DAMAGED</option>
                        <option value="BROKEN_SEAL">BROKEN_SEAL</option>
                        <option value="BLACKLISTED_DEVICE">BLACKLISTED_DEVICE</option>
                        <option value="CONSOLE_ACCESSORY_ISSUES">CONSOLE_ACCESSORY_ISSUES</option>
                        <option value="CONTROLLER_ISSUES">CONTROLLER_ISSUES</option>
                        <option value="CRITICAL_ACCESSORY_ISSUES">CRITICAL_ACCESSORY_ISSUES</option>
                        <option value="CRITICAL_CONDITION_MISMATCH">CRITICAL_CONDITION_MISMATCH</option>
                        <option value="DAMAGED_IN_WAREHOUSE">DAMAGED_IN_WAREHOUSE</option>
                        <option value="EMPTY_PARCEL">EMPTY_PARCEL</option>
                        <option value="JAIL_BROKEN_OR_ROOTED">JAIL_BROKEN_OR_ROOTED</option>
                        <option value="LOCKED_DEVICE">LOCKED_DEVICE</option>
                        <option value="LIKELY_COUNTERFEIT_DEVICE">LIKELY_COUNTERFEIT_DEVICE</option>
                        <option value="LIQUID_DAMAGE">LIQUID_DAMAGE</option>
                        <option value="MULTIPLE_ITEMS">MULTIPLE_ITEMS</option>
                        <option value="NOT_STARTING">NOT_STARTING</option>
                        <option value="SAFETY_ISSUES">SAFETY_ISSUES</option>
                        <option value="SEAL_ISSUES">SEAL_ISSUES</option>
                        <option value="SWOLLEN_BATTERY">SWOLLEN_BATTERY</option>
                        <option value="UNSUPPORTED_DEVICE">UNSUPPORTED_DEVICE</option>
                        <option value="WRONG_ITEM">WRONG_ITEM</option>
                        <option value="WRONG_MODEL">WRONG_MODEL</option>
                        <option value="WRONG_SPECIFICATIONS">WRONG_SPECIFICATIONS</option>
                        <option value="WRONG_STORAGE_CAPACITY">WRONG_STORAGE_CAPACITY</option>
                        <option value="DISC_DRIVE_ISSUES">DISC_DRIVE_ISSUES</option>
                        <option value="SOFTWARE_ISSUES">SOFTWARE_ISSUES</option>
                    </select>
                </div>
            </div>
            
            <!-- Pass All Form Fields -->
            <div id="passAllFormFields" style="display: none;">
                <div class="preview-box" style="background: rgba(0, 204, 102, 0.1); border-color: rgba(0, 204, 102, 0.3);">
                    <strong style="color: #00cc66;">‚úÖ PASS ALL TESTS MODE</strong><br>
                    All tests will be marked as "Passed" or "Not testable" based on console type.
                </div>
            </div>
            
            <!-- Not Testable Info Box -->
            <div class="not-testable-box" id="notTestableBox">
                <div class="not-testable-title">
                    ‚ö†Ô∏è Tests marked as "Not testable" for this console:
                </div>
                <ul class="not-testable-list" id="notTestableList">
                    <!-- Will be populated by JavaScript -->
                </ul>
            </div>
            
            <!-- Action Buttons -->
            <div class="button-group">
                <button class="btn btn-success" onclick="generateAndOpenForm()">
                    <i class="fas fa-rocket"></i>
                    Open Form Now
                </button>
                <button class="btn btn-primary" onclick="addToQueue()">
                    <i class="fas fa-plus-circle"></i>
                    Add to Queue
                </button>
                <button class="btn btn-clear" onclick="clearForm()">
                    <i class="fas fa-redo"></i>
                    Clear Form
                </button>
            </div>
            
            <!-- Success Message -->
            <div class="success-message" id="successMessage">
                ‚úÖ Form added to queue successfully!<br>
                <small>Click the hamburger menu to view your queue.</small>
            </div>
        </div>
        
        <!-- Instructions Section with Keyboard Shortcuts on the right - RESPONSIVE FIX -->
        <div style="display: flex; flex-wrap: wrap; gap: 30px; margin: 30px;">
            <!-- How to Use This Tool -->
            <div class="info-section" style="flex: 1; min-width: 300px;">
                <div class="info-title">
                    <i class="fas fa-graduation-cap"></i>
                    How to Use This Tool
                </div>
                <div class="info-content">
                    1. <strong>Select Form Type:</strong> Failed Test (detailed), Rejection (single reason), or Pass All (all tests passed).
                    <br><br>
                    2. <strong>Fill Basic Info:</strong> Item ID & Serial Number (required).
                    <br><br>
                    3. <strong>For Failed Test Form:</strong> Select Model, then where it failed and why.
                    <br><br>
                    4. <strong>For Rejection Form:</strong> Choose a reason from the list.
                    <br><br>
                    5. <strong>For Pass All Form:</strong> Just fill Model - tests auto-mark as Passed/Not testable.
                    <br><br>
                    <div class="warning-box">
                        <div class="warning-title">
                            ‚ö†Ô∏è IMPORTANT
                        </div>
                        Google Forms may not pre-fill failure reasons automatically. After the form opens, you MUST check and select the failure reason manually if it's not already selected.
                    </div>
                </div>
            </div>
            
            <!-- Keyboard Shortcuts - RESPONSIVE FIX -->
            <div class="keyboard-shortcuts-panel">
                <div class="info-title">
                    <i class="fas fa-keyboard"></i>
                    Keyboard Shortcuts
                </div>
                <div class="info-content">
                    <div class="shortcut-item">
                        <span class="shortcut-key">Ctrl + Enter</span>
                        <span class="shortcut-desc">Open Form</span>
                    </div>
                    <div class="shortcut-item">
                        <span class="shortcut-key">Ctrl + Q</span>
                        <span class="shortcut-desc">Add to Queue</span>
                    </div>
                    <div class="shortcut-item">
                        <span class="shortcut-key">Ctrl + 1/2/3</span>
                        <span class="shortcut-desc">Switch Form Type</span>
                    </div>
                    <div class="shortcut-item">
                        <span class="shortcut-key">Ctrl + L</span>
                        <span class="shortcut-desc">Open Sidebar</span>
                    </div>
                    <div class="shortcut-item">
                        <span class="shortcut-key">F2</span>
                        <span class="shortcut-desc">Swap ID/Serial</span>
                    </div>
                    <div class="shortcut-item">
                        <span class="shortcut-key">Esc</span>
                        <span class="shortcut-desc">Close Sidebar</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- About the Queue Section -->
        <div class="info-section" style="margin: 30px;">
            <div class="info-title">
                <i class="fas fa-info-circle"></i>
                About the Queue
            </div>
            <div class="info-content">
                <div class="info-note">
                    <strong>üìã Queue Features:</strong>
                    <ul class="info-list">
                        <li>Store forms for offline work</li>
                        <li>Batch submit when online</li>
                        <li>Data saved in browser</li>
                        <li>Export to CSV</li>
                        <li>Open all queued forms with one click</li>
                    </ul>
                </div>
                
                <div class="info-note">
                    <strong>üìä Statistics:</strong> Tracks all forms processed today and all time.
                </div>
            </div>
        </div>
        
        <!-- Footer Signature with MULTI-COLOR NAME -->
        <div class="footer-signature">
            <div class="monkey-emojis">
                <div class="monkey">üôà</div>
                <div class="monkey">üôâ</div>
                <div class="monkey">üôä</div>
            </div>
            <div class="created-by">Created by</div>
            <div class="rahim-name">RAHIM</div>
        </div>
    </div>

    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script>
        // Form URLs
        const FORM_URLS = {
            form1: "https://docs.google.com/forms/d/e/1FAIpQLSdw_dydIgIk2lDK02LYyfi-4ytC5i7EEcjwCBV-t2qmcRU-aQ/viewform?pli=1&pli=1",
            form2: "https://docs.google.com/forms/d/e/1FAIpQLSfBIRKz7rHYnRKip_CinYR1dPN7lUkor1B3goSxDQdrdktJ5g/viewform",
            form3: "https://docs.google.com/forms/d/e/1FAIpQLSdw_dydIgIk2lDK02LYyfi-4ytC5i7EEcjwCBV-t2qmcRU-aQ/viewform?pli=1&pli=1"
        };

        const FIELD_IDS_FORM1 = {
            item_id: "entry.264714925",
            serial: "entry.1467120290",
            model: "entry.1645409711",
            auth: "entry.1389653337",
            boot: "entry.582532298",
            buttons: "entry.1182612584",
            jailbreak: "entry.496249149",
            network: "entry.515652933",
            accounts: "entry.1245600276",
            ports: "entry.2000355850",
            disc_storage: "entry.1981842962",
            battery: "entry.1201219719",
            display: "entry.373626164",
            speaker_mic: "entry.1064347633",
            load: "entry.261682137",
            noise_smell: "entry.165249102",
            controller: "entry.23953354",
            accessories: "entry.926040436",
            auth_why: "entry.1882150640",
            boot_why: "entry.1965271608",
            buttons_why: "entry.1567705433",
            jailbreak_why: "entry.2116645276",
            network_why: "entry.1387611846",
            accounts_why: "entry.1009950602",
            ports_why: "entry.910771481",
            disc_storage_why: "entry.198376670",
            battery_why: "entry.91471292",
            display_why: "entry.876337039",
            speaker_mic_why: "entry.728090706",
            load_why: "entry.1847751109",
            noise_smell_why: "entry.1095686758",
            controller_why: "entry.570841000",
            accessories_why: "entry.764500531",
            general: "entry.382102081"
        };

        const FIELD_IDS_FORM2 = {
            item_id: "entry.264714925",
            serial: "entry.1215422911",
            rejection_reason: "entry.1263436854",
            general: "entry.382102081"
        };

        const FAILURE_REASONS = {
            auth: ["Likely nongenuine parts", "Likely counterfeit device", "Seal issues", "Other"],
            boot: ["Not starting", "Short circuiting device", "Liquid damaged device", "Video signal errors", "Software error", "Charging failure", "Wireless charging failure", "Other"],
            buttons: ["Button issues", "Other"],
            jailbreak: ["Jailbroken or rooted device", "Other"],
            network: ["WiFi issues", "Bluetooth issues", "Ethernet issues", "NFC issues", "Other"],
            accounts: ["Locked Device", "Blacklisted Device", "Other"],
            ports: ["Port issues", "HDMI issues", "Video signal errors", "USB issues", "Other"],
            disc_storage: ["Disc drive issues", "Storage device issues", "SD card issues", "Other"],
            battery: ["Battery issues", "Safety issues", "Swollen battery", "Does not charge", "Other"],
            display: ["Screen issues", "Other"],
            speaker_mic: ["Speaker issues", "Microphone issues", "Other"],
            load: ["Game load issues", "Sensor issues", "Other"],
            noise_smell: ["Defective Fan", "Heat issues", "Smell issues (burning smell,broken capacitors)", "Other"],
            controller: ["Controller issues", "Vibration issues", "Other"],
            accessories: ["Critical accessory issues", "Camera issues", "Flash issues", "Other"]
        };

        const TESTS = ["auth", "boot", "buttons", "jailbreak", "network", "accounts", "ports", "disc_storage", "battery", "display", "speaker_mic", "load", "noise_smell", "controller", "accessories"];

        const SPECIAL_CONSOLES = {
            "PlayStation 3": ["battery", "display", "speaker_mic"],
            "PlayStation 4": ["battery", "display", "speaker_mic"],
            "PlayStation 4 slim": ["battery", "display", "speaker_mic"],
            "PlayStation 4 pro": ["battery", "display", "speaker_mic"],
            "PlayStation 5": ["battery", "display", "speaker_mic"],
            "PlayStation 5 digital": ["battery", "display", "speaker_mic", "disc_storage"],
            "PlayStation 5 pro": ["battery", "display", "speaker_mic"],
            "Xbox One (Original)": ["battery", "display", "speaker_mic"],
            "Xbox One S": ["battery", "display", "speaker_mic"],
            "Xbox One X": ["battery", "display", "speaker_mic"],
            "Xbox Series X": ["battery", "display", "speaker_mic"],
            "Xbox 360": ["battery", "display", "speaker_mic"],
            "PlayStation 5 digital": ["battery", "display", "speaker_mic", "disc_storage"],
            "Xbox Series S": ["battery", "display", "speaker_mic", "disc_storage"],
            "PlayStation Portable": ["controller"],
            "PlayStation Portal 2025": ["disc_storage", "load"],
            "PlayStation Vita": ["controller"],
            "Nintendo DS": ["network", "accounts", "controller"],
            "Nintendo 2DS (Original)": ["controller"],
            "Nintendo 3DS (Original)": ["controller"],
            "Nintendo 3DS XL": ["controller"],
            "New Nintendo 3DS": ["controller"],
            "New Nintendo 3DS XL": ["controller"],
            "New Nintendo 2DS XL": ["controller"],
            "Nintendo DSi": ["controller"],
            "Nintendo DSi XL": ["controller"],
            "Nintendo Wii": ["display", "speaker_mic", "battery"],
            "Nintendo 64 (Original)": ["network", "accounts", "battery", "speaker_mic", "display"],
            "PlayStation 1": ["network", "accounts", "battery", "speaker_mic", "display"],
            "PlayStation 2": ["network", "accounts", "battery", "speaker_mic", "display"]
        };

        // Console categories for tracking
        const CONSOLE_CATEGORIES = {
            "PlayStation": ["PlayStation 1", "PlayStation 2", "PlayStation 3", "PlayStation 4", "PlayStation 4 slim", "PlayStation 4 pro", "PlayStation 5", "PlayStation 5 digital", "PlayStation 5 pro", "PlayStation Portal 2025", "PlayStation Portable", "PlayStation Vita"],
            "Xbox": ["Xbox (original)", "Xbox 360", "Xbox One (Original)", "Xbox One S", "Xbox One X", "Xbox Series S", "Xbox Series X"],
            "Nintendo": ["Nintendo DS", "Nintendo 2DS (Original)", "Nintendo 3DS (Original)", "Nintendo 3DS XL", "New Nintendo 3DS", "New Nintendo 3DS XL", "New Nintendo 2DS XL", "Nintendo DSi", "Nintendo DSi XL", "Nintendo 64 (Original)", "Nintendo Switch", "Nintendo Switch 2", "Nintendo Game Boy", "Nintendo Game Boy Advance", "Nintendo Wii", "Nintendo Wii U"],
            "Handheld PCs": ["Asus ROG Ally (2023)", "Asus ROG Ally X (2024)", "Lenovo Legion Go", "Steam Deck"],
            "Other": ["device not supported"]
        };

        let CURRENT_FORM = 'form1';
        let CURRENT_FIELD_IDS = FIELD_IDS_FORM1;
        let currentConsoleTab = 'today';
        let currentStatsTab = 'today';

        // Stats Tracking
        let stats = {
            today: {
                total: 0,
                passed: 0,
                failed: 0,
                queued: 0
            },
            alltime: {
                total: 0,
                passed: 0,
                failed: 0,
                queued: 0
            }
        };

        // Console Statistics
        let consoleStats = {
            daily: {},
            alltime: {}
        };

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadStats();
            loadConsoleStats();
            updateStatsDisplay();
            updateConsoleStatsDisplay();
            updateQueueUI();
            selectForm('form1');
            document.getElementById('item_id').focus();
            
            // Auto-fix form URL if needed
            autoFixFormURLs();
            
            // Check for midnight reset
            checkMidnightReset();
        });

        function loadStats() {
            const saved = localStorage.getItem('consoleTestStats');
            if (saved) {
                stats = JSON.parse(saved);
                // Update queued count from actual queue
                stats.today.queued = getQueue().length;
                stats.alltime.queued = getQueue().length;
            }
        }

        function saveStats() {
            localStorage.setItem('consoleTestStats', JSON.stringify(stats));
        }

        function loadConsoleStats() {
            const saved = localStorage.getItem('consoleTestConsoleStats');
            if (saved) {
                consoleStats = JSON.parse(saved);
            }
        }

        function saveConsoleStats() {
            localStorage.setItem('consoleTestConsoleStats', JSON.stringify(consoleStats));
        }

        function updateStatsDisplay() {
            const currentStats = currentStatsTab === 'today' ? stats.today : stats.alltime;
            
            document.getElementById('statTotal').textContent = currentStats.total;
            document.getElementById('statPassed').textContent = currentStats.passed;
            document.getElementById('statFailed').textContent = currentStats.failed;
            document.getElementById('statQueued').textContent = currentStats.queued;
            saveStats();
        }

        function switchStatsTab(tab) {
            currentStatsTab = tab;
            
            // Update tab buttons
            document.querySelectorAll('.stats-tab').forEach(tabElement => {
                tabElement.classList.remove('active');
            });
            event.target.classList.add('active');
            
            updateStatsDisplay();
        }

        function updateConsoleStatsDisplay() {
            const searchTerm = document.getElementById('consoleSearch').value.toLowerCase();
            const categoriesContainer = document.getElementById('consoleCategories');
            
            // Clear existing content
            categoriesContainer.innerHTML = '';
            
            // Sort categories by count (today or alltime)
            const categories = Object.keys(CONSOLE_CATEGORIES);
            
            // Calculate totals for sorting
            const categoryTotals = {};
            categories.forEach(category => {
                if (currentConsoleTab === 'today') {
                    categoryTotals[category] = getCategoryTodayCount(category);
                } else {
                    categoryTotals[category] = getCategoryAllTimeCount(category);
                }
            });
            
            // Sort by total count (descending)
            const sortedCategories = categories.sort((a, b) => {
                return categoryTotals[b] - categoryTotals[a];
            });
            
            // Create category elements
            sortedCategories.forEach(category => {
                if (category.toLowerCase().includes(searchTerm) || searchTerm === '') {
                    const todayCount = getCategoryTodayCount(category);
                    const allTimeCount = getCategoryAllTimeCount(category);
                    
                    // Only show categories with counts
                    if (todayCount > 0 || allTimeCount > 0) {
                        const categoryElement = document.createElement('div');
                        categoryElement.className = 'console-category';
                        categoryElement.onclick = () => showConsoleBreakdown(category);
                        
                        // Get top 3 models for this category
                        const topModels = getTopModelsForCategory(category, 3);
                        
                        categoryElement.innerHTML = `
                            <div class="console-category-header">
                                <div class="console-name">${category}</div>
                                <div class="console-counts">
                                    <span class="today-count">Today: ${todayCount}</span>
                                    <span class="alltime-count">All Time: ${allTimeCount}</span>
                                </div>
                            </div>
                            <div class="console-breakdown">
                                ${topModels.map(model => `
                                    <div class="breakdown-item">
                                        <span>${model.name}</span>
                                        <span>${currentConsoleTab === 'today' ? model.today : model.alltime}</span>
                                    </div>
                                `).join('')}
                            </div>
                        `;
                        
                        categoriesContainer.appendChild(categoryElement);
                    }
                }
            });
            
            // If no results, show message
            if (categoriesContainer.children.length === 0) {
                categoriesContainer.innerHTML = `
                    <div class="queue-empty">
                        <div class="queue-empty-icon">üéÆ</div>
                        <div class="queue-empty-text">
                            No consoles tested yet<br>
                            Start testing to see statistics here
                        </div>
                    </div>
                `;
            }
        }

        function getCategoryTodayCount(category) {
            let total = 0;
            const models = CONSOLE_CATEGORIES[category];
            models.forEach(model => {
                if (consoleStats.daily[model]) {
                    total += consoleStats.daily[model];
                }
            });
            return total;
        }

        function getCategoryAllTimeCount(category) {
            let total = 0;
            const models = CONSOLE_CATEGORIES[category];
            models.forEach(model => {
                if (consoleStats.alltime[model]) {
                    total += consoleStats.alltime[model];
                }
            });
            return total;
        }

        function getTopModelsForCategory(category, limit = 3) {
            const models = CONSOLE_CATEGORIES[category];
            const modelStats = [];
            
            models.forEach(model => {
                const today = consoleStats.daily[model] || 0;
                const alltime = consoleStats.alltime[model] || 0;
                
                if (today > 0 || alltime > 0) {
                    modelStats.push({
                        name: model,
                        today: today,
                        alltime: alltime
                    });
                }
            });
            
            // Sort by current tab's count
            modelStats.sort((a, b) => {
                if (currentConsoleTab === 'today') {
                    return b.today - a.today;
                } else {
                    return b.alltime - a.alltime;
                }
            });
            
            return modelStats.slice(0, limit);
        }

        function updateConsoleStats(model) {
            const today = new Date().toISOString().split('T')[0];
            
            // Initialize if needed
            if (!consoleStats.daily[today]) {
                consoleStats.daily[today] = {};
            }
            
            // Update daily stats
            if (!consoleStats.daily[today][model]) {
                consoleStats.daily[today][model] = 0;
            }
            consoleStats.daily[today][model]++;
            
            // Update all-time stats
            if (!consoleStats.alltime[model]) {
                consoleStats.alltime[model] = 0;
            }
            consoleStats.alltime[model]++;
            
            saveConsoleStats();
            updateConsoleStatsDisplay();
        }

        function switchConsoleTab(tab) {
            currentConsoleTab = tab;
            
            // Update tab buttons
            document.querySelectorAll('.console-tab').forEach(tabElement => {
                tabElement.classList.remove('active');
            });
            event.target.classList.add('active');
            
            updateConsoleStatsDisplay();
        }

        function filterConsoles() {
            updateConsoleStatsDisplay();
        }

        function showConsoleBreakdown(category) {
            const models = CONSOLE_CATEGORIES[category];
            let breakdownHTML = `<strong>${category} - Detailed Breakdown:</strong><br><br>`;
            
            models.forEach(model => {
                const today = consoleStats.daily[model] || 0;
                const alltime = consoleStats.alltime[model] || 0;
                
                if (today > 0 || alltime > 0) {
                    breakdownHTML += `${model}: Today: ${today}, All Time: ${alltime}<br>`;
                }
            });
            
            alert(breakdownHTML);
        }

        function selectForm(formId) {
            CURRENT_FORM = formId;
            
            document.getElementById('form1Option').classList.remove('selected');
            document.getElementById('form2Option').classList.remove('selected');
            document.getElementById('form3Option').classList.remove('selected');
            document.getElementById(formId + 'Option').classList.add('selected');
            
            if (formId === 'form1') {
                CURRENT_FIELD_IDS = FIELD_IDS_FORM1;
                document.getElementById('formPreview').innerHTML = 
                    'Currently selected: <strong style="color:#ff3333">FAILED TEST</strong> ‚Äî Detailed testing with cascade logic';
                
                document.getElementById('liveFormFields').style.display = 'block';
                document.getElementById('rejectionFormFields').style.display = 'none';
                document.getElementById('passAllFormFields').style.display = 'none';
                document.getElementById('notTestableBox').style.display = 'none';
                
                // Show failure fields for form1
                document.getElementById('failureFields').style.display = 'block';
            } else if (formId === 'form2') {
                CURRENT_FIELD_IDS = FIELD_IDS_FORM2;
                document.getElementById('formPreview').innerHTML = 
                    'Currently selected: <strong style="color:#ff3333">REJECTION</strong> ‚Äî Single reason rejection';
                
                document.getElementById('liveFormFields').style.display = 'none';
                document.getElementById('rejectionFormFields').style.display = 'block';
                document.getElementById('passAllFormFields').style.display = 'none';
                document.getElementById('notTestableBox').style.display = 'none';
            } else if (formId === 'form3') {
                CURRENT_FIELD_IDS = FIELD_IDS_FORM1;
                document.getElementById('formPreview').innerHTML = 
                    'Currently selected: <strong style="color:#00cc66">PASS ALL TESTS</strong> ‚Äî All tests passed or not testable';
                
                document.getElementById('liveFormFields').style.display = 'block';
                document.getElementById('rejectionFormFields').style.display = 'none';
                document.getElementById('passAllFormFields').style.display = 'block';
                
                // HIDE failure fields for form3
                document.getElementById('failureFields').style.display = 'none';
                
                // Update not testable info when switching to form3
                const model = document.getElementById('model').value;
                if (model) {
                    updateNotTestableInfo();
                }
            }
        }

        function updateFailureReasons() {
            const failurePoint = document.getElementById('failure_point').value;
            const reasonSelect = document.getElementById('failure_reason');
            
            reasonSelect.innerHTML = '';
            
            if (!failurePoint) {
                reasonSelect.innerHTML = '<option value="">Select failure point first</option>';
                return;
            }
            
            const reasons = FAILURE_REASONS[failurePoint] || ["Other"];
            reasons.forEach(reason => {
                const option = document.createElement('option');
                option.value = reason;
                option.textContent = reason;
                reasonSelect.appendChild(option);
            });
        }

        function updateNotTestableInfo() {
            const model = document.getElementById('model').value;
            const notTestableBox = document.getElementById('notTestableBox');
            const notTestableList = document.getElementById('notTestableList');
            
            // Clear the list
            notTestableList.innerHTML = '';
            
            // Only show for Pass All Tests form
            if (CURRENT_FORM !== 'form3') {
                notTestableBox.style.display = 'none';
                return;
            }
            
            if (!model) {
                notTestableBox.style.display = 'none';
                return;
            }
            
            const specialTests = SPECIAL_CONSOLES[model];
            
            if (specialTests && specialTests.length > 0) {
                notTestableBox.style.display = 'block';
                
                // Add tests that will be marked as "Not testable"
                specialTests.forEach(test => {
                    const li = document.createElement('li');
                    li.textContent = getTestDisplayName(test);
                    notTestableList.appendChild(li);
                });
            } else {
                notTestableBox.style.display = 'none';
            }
        }

        function getTestDisplayName(testKey) {
            const testNames = {
                "auth": "Authenticity check",
                "boot": "Powering on and booting up",
                "buttons": "Buttons test",
                "jailbreak": "Jailbreak test",
                "network": "Network connections test",
                "accounts": "Accounts check",
                "ports": "Ports test",
                "disc_storage": "Disc drive and storage test",
                "battery": "Battery test",
                "display": "Display test",
                "speaker_mic": "Speaker and microphone test",
                "load": "Load test",
                "noise_smell": "Noise and smell test",
                "controller": "Controller test",
                "accessories": "Accessories test"
            };
            return testNames[testKey] || testKey;
        }

        function isTestNotTestableForConsole(consoleModel, testName) {
            const specialTests = SPECIAL_CONSOLES[consoleModel];
            return specialTests && specialTests.includes(testName);
        }

        // Queue Management
        function getQueue() {
            const queue = localStorage.getItem('consoleTestQueue');
            return queue ? JSON.parse(queue) : [];
        }

        function saveQueue(queue) {
            localStorage.setItem('consoleTestQueue', JSON.stringify(queue));
            updateQueueUI();
            // Update stats queued count
            stats.today.queued = queue.length;
            stats.alltime.queued = queue.length;
            updateStatsDisplay();
        }

        function collectFormData() {
            const itemId = document.getElementById('item_id').value.trim();
            const serial = document.getElementById('serial').value.trim();
            
            if (!itemId || !serial) {
                alert("‚ùå Please fill Item ID and Serial Number");
                return null;
            }
            
            const formData = {
                formType: CURRENT_FORM,
                itemId: itemId,
                serial: serial
            };
            
            if (CURRENT_FORM === 'form1' || CURRENT_FORM === 'form3') {
                const model = document.getElementById('model').value;
                
                if (!model) {
                    alert("‚ùå Please select Model");
                    return null;
                }
                
                formData.model = model;
                
                if (CURRENT_FORM === 'form1') {
                    const failurePoint = document.getElementById('failure_point').value;
                    const failureReason = document.getElementById('failure_reason').value;
                    
                    if (!failurePoint) {
                        alert("‚ùå Please select Failure Point for FAILED TEST form");
                        return null;
                    }
                    
                    formData.failurePoint = failurePoint;
                    formData.failureReason = failureReason;
                }
                
            } else if (CURRENT_FORM === 'form2') {
                const rejectionReason = document.getElementById('rejection_reason').value;
                
                if (!rejectionReason) {
                    alert("‚ùå Please select a rejection reason");
                    return null;
                }
                
                formData.rejectionReason = rejectionReason;
            }
            
            return formData;
        }

        function generateAndOpenForm() {
            const formData = collectFormData();
            if (!formData) return;
            
            const url = generateFormURL(formData);
            
            // Open form in new tab
            window.open(url, '_blank');
            
            // Update stats
            updateFormStats(formData);
            
            // Update console stats if model exists
            if (formData.model) {
                updateConsoleStats(formData.model);
            }
            
            clearForm();
        }

        function addToQueue() {
            const formData = collectFormData();
            if (!formData) return;
            
            const queue = getQueue();
            queue.push({
                id: Date.now(),
                timestamp: new Date().toISOString(),
                ...formData
            });
            saveQueue(queue);
            
            // Update stats
            updateFormStats(formData);
            
            // Update console stats if model exists
            if (formData.model) {
                updateConsoleStats(formData.model);
            }
            
            // Show success message
            const successMsg = document.getElementById('successMessage');
            successMsg.style.display = 'block';
            setTimeout(() => {
                successMsg.style.display = 'none';
            }, 3000);
            
            clearForm();
        }

        function updateFormStats(formData) {
            // Update today's stats
            stats.today.total++;
            if (formData.formType === 'form3') stats.today.passed++;
            else if (formData.formType === 'form2' || formData.formType === 'form1') stats.today.failed++;
            
            // Update all-time stats
            stats.alltime.total++;
            if (formData.formType === 'form3') stats.alltime.passed++;
            else if (formData.formType === 'form2' || formData.formType === 'form1') stats.alltime.failed++;
            
            updateStatsDisplay();
        }

        function generateFormURL(formData) {
            const baseUrl = FORM_URLS[formData.formType];
            
            if (!baseUrl) {
                alert("Error: Form URL not found. Please check the form configuration.");
                return "#";
            }
            
            let url = baseUrl + (baseUrl.includes('?') ? '&' : '?');
            
            if (formData.formType === 'form1') {
                // FAILED TEST form - FULLY FILLED
                url += FIELD_IDS_FORM1.item_id + "=" + encodeURIComponent(formData.itemId) + "&";
                url += FIELD_IDS_FORM1.serial + "=" + encodeURIComponent(formData.serial) + "&";
                url += FIELD_IDS_FORM1.model + "=" + encodeURIComponent(formData.model) + "&";
                
                let failed = false;
                TESTS.forEach(test => {
                    if (failed) {
                        // Everything after the failure point is "Not testable"
                        url += FIELD_IDS_FORM1[test] + "=" + encodeURIComponent("Not testable") + "&";
                    } else if (test === formData.failurePoint) {
                        // Mark the failure point as "failed"
                        if (test === "disc_storage") {
                            url += FIELD_IDS_FORM1[test] + "=" + encodeURIComponent("Failed") + "&";
                        } else {
                            url += FIELD_IDS_FORM1[test] + "=" + encodeURIComponent("failed") + "&";
                        }
                        
                        // Fill the failure reason
                        if (formData.failureReason) {
                            const whyField = FIELD_IDS_FORM1[formData.failurePoint + "_why"];
                            if (whyField) {
                                url += whyField + "=" + encodeURIComponent(formData.failureReason) + "&";
                            }
                        }
                        failed = true;
                    } else {
                        // Everything before the failure point is "passed"
                        url += FIELD_IDS_FORM1[test] + "=" + encodeURIComponent("passed") + "&";
                    }
                });
                
                // General field is "failed"
                url += FIELD_IDS_FORM1.general + "=" + encodeURIComponent("failed");
                
            } else if (formData.formType === 'form2') {
                // REJECTION form - FULLY FILLED
                url += FIELD_IDS_FORM2.item_id + "=" + encodeURIComponent(formData.itemId) + "&";
                url += FIELD_IDS_FORM2.serial + "=" + encodeURIComponent(formData.serial) + "&";
                url += FIELD_IDS_FORM2.rejection_reason + "=" + encodeURIComponent(formData.rejectionReason) + "&";
                
                // General field is "failed"
                url += FIELD_IDS_FORM2.general + "=" + encodeURIComponent("failed");
                
            } else if (formData.formType === 'form3') {
                // PASS ALL TESTS form - FULLY FILLED with special console handling
                url += FIELD_IDS_FORM1.item_id + "=" + encodeURIComponent(formData.itemId) + "&";
                url += FIELD_IDS_FORM1.serial + "=" + encodeURIComponent(formData.serial) + "&";
                url += FIELD_IDS_FORM1.model + "=" + encodeURIComponent(formData.model) + "&";
                
                // Handle each test based on console type
                TESTS.forEach(test => {
                    if (isTestNotTestableForConsole(formData.model, test)) {
                        // Special console - mark as "Not testable"
                        url += FIELD_IDS_FORM1[test] + "=" + encodeURIComponent("Not testable") + "&";
                    } else {
                        // Normal console - mark as "passed"
                        url += FIELD_IDS_FORM1[test] + "=" + encodeURIComponent("passed") + "&";
                    }
                });
                
                // General field is "passed"
                url += FIELD_IDS_FORM1.general + "=" + encodeURIComponent("passed");
            }
            
            return url;
        }

        function updateQueueUI() {
            const queue = getQueue();
            const count = document.getElementById('queueCount');
            const content = document.getElementById('queueContent');
            
            count.textContent = queue.length;
            
            if (queue.length === 0) {
                content.innerHTML = `
                    <div class="queue-empty">
                        <div class="queue-empty-icon">üìã</div>
                        <div class="queue-empty-text">
                            No forms queued yet<br>
                            Fill out a form and click "Add to Queue"
                        </div>
                    </div>
                `;
                document.getElementById('submitAllBtn').disabled = true;
            } else {
                document.getElementById('submitAllBtn').disabled = false;
                content.innerHTML = queue.map(item => {
                    const timeAgo = getTimeAgo(item.timestamp);
                    const formTypeName = item.formType === 'form1' ? 'Failed Test' : 
                                        item.formType === 'form2' ? 'Rejection' : 'Pass All Tests';
                    
                    let details = `Serial: ${item.serial}`;
                    if (item.model) details += `<br>Model: ${item.model}`;
                    if (item.failurePoint) details += `<br>Failure: ${item.failurePoint}`;
                    if (item.rejectionReason) details += `<br>Reason: ${item.rejectionReason}`;
                    
                    return `
                        <div class="queue-item ${item.formType}">
                            <div class="queue-item-header">
                                <div class="queue-item-id">${item.itemId}</div>
                                <div class="queue-item-type ${item.formType}">${formTypeName}</div>
                            </div>
                            <div class="queue-item-details">${details}</div>
                            <div class="queue-item-time">‚è±Ô∏è ${timeAgo}</div>
                            <div class="queue-item-actions">
                                <button class="queue-item-btn" onclick="submitSingleForm(${item.id})">üì§ Open Form</button>
                                <button class="queue-item-btn delete" onclick="removeFromQueue(${item.id})">üóëÔ∏è Delete</button>
                            </div>
                        </div>
                    `;
                }).join('');
            }
        }

        function getTimeAgo(timestamp) {
            const now = new Date();
            const past = new Date(timestamp);
            const diffMs = now - past;
            const diffMins = Math.floor(diffMs / 60000);
            
            if (diffMins < 1) return 'Just now';
            if (diffMins === 1) return '1 minute ago';
            if (diffMins < 60) return `${diffMins} minutes ago`;
            
            const diffHours = Math.floor(diffMins / 60);
            if (diffHours === 1) return '1 hour ago';
            if (diffHours < 24) return `${diffHours} hours ago`;
            
            const diffDays = Math.floor(diffHours / 24);
            if (diffDays === 1) return '1 day ago';
            return `${diffDays} days ago`;
        }

        function openSidebar() {
            document.getElementById('sidebar').classList.add('open');
            document.getElementById('sidebarBackdrop').classList.add('show');
        }

        function closeSidebar() {
            document.getElementById('sidebar').classList.remove('open');
            document.getElementById('sidebarBackdrop').classList.remove('show');
        }

        function removeFromQueue(id) {
            const queue = getQueue();
            const filtered = queue.filter(item => item.id !== id);
            saveQueue(filtered);
        }

        function submitSingleForm(id) {
            const queue = getQueue();
            const item = queue.find(q => q.id === id);
            
            if (!item) return;
            
            const url = generateFormURL(item);
            window.open(url, '_blank');
            
            // Update stats
            updateFormStats(item);
            
            // Update console stats if model exists
            if (item.model) {
                updateConsoleStats(item.model);
            }
            
            stats.today.queued--;
            stats.alltime.queued--;
            updateStatsDisplay();
            
            setTimeout(() => {
                if (confirm('Form opened. Remove from queue?')) {
                    removeFromQueue(id);
                }
            }, 1000);
        }

        function submitAllQueued() {
            const queue = getQueue();
            
            if (queue.length === 0) {
                alert("No forms in queue");
                return;
            }
            
            const confirmed = confirm(`Open ${queue.length} form(s) in new tabs?`);
            if (!confirmed) return;
            
            // Disable button to prevent double-clicks
            const submitBtn = document.getElementById('submitAllBtn');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Processing...';
            submitBtn.disabled = true;
            
            // Open ALL forms with proper delays
            let openedCount = 0;
            
            queue.forEach((item, index) => {
                setTimeout(() => {
                    const url = generateFormURL(item);
                    window.open(url, '_blank');
                    openedCount++;
                    
                    // Update stats
                    updateFormStats(item);
                    
                    // Update console stats if model exists
                    if (item.model) {
                        updateConsoleStats(item.model);
                    }
                    
                    // Remove from queue after opening
                    removeFromQueue(item.id);
                    
                    // Update progress
                    if (openedCount === queue.length) {
                        setTimeout(() => {
                            submitBtn.innerHTML = originalText;
                            submitBtn.disabled = false;
                            alert(`‚úÖ ${openedCount} form(s) opened successfully!\nQueue has been cleared.`);
                            closeSidebar();
                        }, 500);
                    }
                }, index * 1000); // 1 second delay between forms
            });
        }

        function exportQueueAsCSV() {
            const queue = getQueue();
            
            if (queue.length === 0) {
                alert("No forms to export");
                return;
            }
            
            // CSV headers
            let csv = "Date,Time,Item ID,Serial Number,Model,Form Type,Failure Point,Failure Reason,Rejection Reason\n";
            
            // Add rows
            queue.forEach(item => {
                const date = new Date(item.timestamp);
                const dateStr = date.toLocaleDateString();
                const timeStr = date.toLocaleTimeString();
                const formTypeName = item.formType === 'form1' ? 'Failed Test' : 
                                    item.formType === 'form2' ? 'Rejection' : 'Pass All Tests';
                
                csv += `${dateStr},${timeStr},"${item.itemId}","${item.serial}","${item.model || ''}","${formTypeName}","${item.failurePoint || ''}","${item.failureReason || ''}","${item.rejectionReason || ''}"\n`;
            });
            
            // Create download
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `console_test_queue_${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            alert("‚úÖ Queue exported as CSV!");
        }

        function clearQueue() {
            if (confirm('Are you sure you want to clear all queued forms?')) {
                localStorage.removeItem('consoleTestQueue');
                updateQueueUI();
                stats.today.queued = 0;
                stats.alltime.queued = 0;
                updateStatsDisplay();
            }
        }

        function checkMidnightReset() {
            const today = new Date().toISOString().split('T')[0];
            const lastReset = localStorage.getItem('consoleTestLastReset');
            
            if (lastReset !== today) {
                // Reset today's stats
                stats.today.total = 0;
                stats.today.passed = 0;
                stats.today.failed = 0;
                stats.today.queued = getQueue().length;
                
                // Clear today's console stats
                consoleStats.daily = {};
                
                // Save the reset date
                localStorage.setItem('consoleTestLastReset', today);
                saveStats();
                saveConsoleStats();
                
                updateStatsDisplay();
                updateConsoleStatsDisplay();
            }
        }

        function clearForm() {
            document.getElementById('item_id').value = '';
            document.getElementById('serial').value = '';
            document.getElementById('model').value = '';
            document.getElementById('failure_point').value = '';
            document.getElementById('failure_reason').value = '';
            document.getElementById('rejection_reason').value = '';
            
            document.getElementById('notTestableBox').style.display = 'none';
            
            document.getElementById('item_id').focus();
        }

        // Auto-fix form URLs function
        function autoFixFormURLs() {
            // Check if FORM_URLS form2 has a typo and fix it
            if (FORM_URLS.form2 && FORM_URLS.form2.includes("google.comforms")) {
                FORM_URLS.form2 = FORM_URLS.form2.replace("google.comforms", "google.com/forms");
            }
        }

        // Keyboard shortcuts - F2 without popup
        let lastF2Time = 0;
        
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'Enter') {
                e.preventDefault();
                generateAndOpenForm();
            }
            if (e.ctrlKey && e.key === 'q') {
                e.preventDefault();
                addToQueue();
            }
            if (e.ctrlKey && e.key === '1') {
                e.preventDefault();
                selectForm('form1');
            }
            if (e.ctrlKey && e.key === '2') {
                e.preventDefault();
                selectForm('form2');
            }
            if (e.ctrlKey && e.key === '3') {
                e.preventDefault();
                selectForm('form3');
            }
            if (e.ctrlKey && e.key === 'l') {
                e.preventDefault();
                openSidebar();
            }
            if (e.key === 'F2') {
                e.preventDefault();
                // Prevent multiple rapid swaps
                const now = Date.now();
                if (now - lastF2Time > 500) { // 500ms delay between swaps
                    swapIdSerial();
                    lastF2Time = now;
                }
            }
            if (e.key === 'Escape') {
                closeSidebar();
            }
        });

        function swapIdSerial() {
            const itemId = document.getElementById('item_id');
            const serial = document.getElementById('serial');
            
            const temp = itemId.value;
            itemId.value = serial.value;
            serial.value = temp;
        }
    </script>
</body>
</html>
